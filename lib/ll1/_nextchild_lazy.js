'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.default = _nextchild_lazy;

var _error = require('../error');

var _parse_lazy2 = require('./_parse_lazy');

var _parse_lazy3 = _interopRequireDefault(_parse_lazy2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

/**
 * Get next child of table-driven predictive lazy parsing.
 *
 * @param grammar
 * @param table
 * @param stream
 * @param token
 * @returns {Array}
 */
function _nextchild_lazy(eof, grammar, table, stream, expected) {

	var lookahead = stream.read();

	if (lookahead === stream.eof) {
		if (expected.terminal === eof) return expected;else throw new _error.ExpectedEndOfFileError(lookahead);
	}

	if (expected.type === 'leaf') {
		if (lookahead.terminal === expected.terminal) return lookahead;else throw new _error.LookaheadMismatchError(lookahead, [expected]);
	}

	stream.unread(lookahead);

	var router = table.get(expected.nonterminal);

	var next = router.get(lookahead === stream.eof ? eof : lookahead.terminal);

	if (next === undefined) throw new _error.LookaheadMismatchError(lookahead, [].concat(_toConsumableArray(router.keys())));else return (0, _parse_lazy3.default)(eof, grammar, table, grammar.get(expected.nonterminal).get(next), stream, expected.nonterminal, next);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9sbDEvX25leHRjaGlsZF9sYXp5LmpzIl0sIm5hbWVzIjpbIl9uZXh0Y2hpbGRfbGF6eSIsImVvZiIsImdyYW1tYXIiLCJ0YWJsZSIsInN0cmVhbSIsImV4cGVjdGVkIiwibG9va2FoZWFkIiwicmVhZCIsInRlcm1pbmFsIiwidHlwZSIsInVucmVhZCIsInJvdXRlciIsImdldCIsIm5vbnRlcm1pbmFsIiwibmV4dCIsInVuZGVmaW5lZCIsImtleXMiXSwibWFwcGluZ3MiOiI7Ozs7O2tCQVl3QkEsZTs7QUFaeEI7O0FBQ0E7Ozs7Ozs7O0FBRUE7Ozs7Ozs7OztBQVNlLFNBQVNBLGVBQVQsQ0FBMkJDLEdBQTNCLEVBQWdDQyxPQUFoQyxFQUEwQ0MsS0FBMUMsRUFBa0RDLE1BQWxELEVBQTJEQyxRQUEzRCxFQUFzRTs7QUFFcEYsS0FBTUMsWUFBWUYsT0FBT0csSUFBUCxFQUFsQjs7QUFFQSxLQUFLRCxjQUFjRixPQUFPSCxHQUExQixFQUFnQztBQUMvQixNQUFLSSxTQUFTRyxRQUFULEtBQXNCUCxHQUEzQixFQUFpQyxPQUFPSSxRQUFQLENBQWpDLEtBQ0ssTUFBTSxrQ0FBNEJDLFNBQTVCLENBQU47QUFDTDs7QUFFRCxLQUFLRCxTQUFTSSxJQUFULEtBQWtCLE1BQXZCLEVBQWdDO0FBQy9CLE1BQUtILFVBQVVFLFFBQVYsS0FBdUJILFNBQVNHLFFBQXJDLEVBQWdELE9BQU9GLFNBQVAsQ0FBaEQsS0FDSyxNQUFNLGtDQUEyQkEsU0FBM0IsRUFBc0MsQ0FBQ0QsUUFBRCxDQUF0QyxDQUFOO0FBQ0w7O0FBRURELFFBQU9NLE1BQVAsQ0FBY0osU0FBZDs7QUFFQSxLQUFNSyxTQUFTUixNQUFNUyxHQUFOLENBQVVQLFNBQVNRLFdBQW5CLENBQWY7O0FBRUEsS0FBTUMsT0FBT0gsT0FBT0MsR0FBUCxDQUFXTixjQUFjRixPQUFPSCxHQUFyQixHQUEyQkEsR0FBM0IsR0FBaUNLLFVBQVVFLFFBQXRELENBQWI7O0FBRUEsS0FBS00sU0FBU0MsU0FBZCxFQUEwQixNQUFNLGtDQUEyQlQsU0FBM0IsK0JBQTBDSyxPQUFPSyxJQUFQLEVBQTFDLEdBQU4sQ0FBMUIsS0FFSyxPQUFPLDBCQUFZZixHQUFaLEVBQWlCQyxPQUFqQixFQUEwQkMsS0FBMUIsRUFBaUNELFFBQVFVLEdBQVIsQ0FBWVAsU0FBU1EsV0FBckIsRUFBa0NELEdBQWxDLENBQXNDRSxJQUF0QyxDQUFqQyxFQUE4RVYsTUFBOUUsRUFBdUZDLFNBQVNRLFdBQWhHLEVBQThHQyxJQUE5RyxDQUFQO0FBRUwiLCJmaWxlIjoiX25leHRjaGlsZF9sYXp5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTG9va2FoZWFkTWlzbWF0Y2hFcnJvciAsIEV4cGVjdGVkRW5kT2ZGaWxlRXJyb3IgfSBmcm9tICcuLi9lcnJvcicgO1xuaW1wb3J0IF9wYXJzZV9sYXp5IGZyb20gJy4vX3BhcnNlX2xhenknIDtcblxuLyoqXG4gKiBHZXQgbmV4dCBjaGlsZCBvZiB0YWJsZS1kcml2ZW4gcHJlZGljdGl2ZSBsYXp5IHBhcnNpbmcuXG4gKlxuICogQHBhcmFtIGdyYW1tYXJcbiAqIEBwYXJhbSB0YWJsZVxuICogQHBhcmFtIHN0cmVhbVxuICogQHBhcmFtIHRva2VuXG4gKiBAcmV0dXJucyB7QXJyYXl9XG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIF9uZXh0Y2hpbGRfbGF6eSAoIGVvZiwgZ3JhbW1hciAsIHRhYmxlICwgc3RyZWFtICwgZXhwZWN0ZWQgKSB7XG5cblx0Y29uc3QgbG9va2FoZWFkID0gc3RyZWFtLnJlYWQoICkgO1xuXG5cdGlmICggbG9va2FoZWFkID09PSBzdHJlYW0uZW9mICkge1xuXHRcdGlmICggZXhwZWN0ZWQudGVybWluYWwgPT09IGVvZiApIHJldHVybiBleHBlY3RlZCA7XG5cdFx0ZWxzZSB0aHJvdyBuZXcgRXhwZWN0ZWRFbmRPZkZpbGVFcnJvciggbG9va2FoZWFkICkgO1xuXHR9XG5cblx0aWYgKCBleHBlY3RlZC50eXBlID09PSAnbGVhZicgKSB7XG5cdFx0aWYgKCBsb29rYWhlYWQudGVybWluYWwgPT09IGV4cGVjdGVkLnRlcm1pbmFsICkgcmV0dXJuIGxvb2thaGVhZCA7XG5cdFx0ZWxzZSB0aHJvdyBuZXcgTG9va2FoZWFkTWlzbWF0Y2hFcnJvcihsb29rYWhlYWQsIFtleHBlY3RlZF0pIDtcblx0fVxuXG5cdHN0cmVhbS51bnJlYWQobG9va2FoZWFkKTtcblxuXHRjb25zdCByb3V0ZXIgPSB0YWJsZS5nZXQoZXhwZWN0ZWQubm9udGVybWluYWwpO1xuXG5cdGNvbnN0IG5leHQgPSByb3V0ZXIuZ2V0KGxvb2thaGVhZCA9PT0gc3RyZWFtLmVvZiA/IGVvZiA6IGxvb2thaGVhZC50ZXJtaW5hbCkgO1xuXG5cdGlmICggbmV4dCA9PT0gdW5kZWZpbmVkICkgdGhyb3cgbmV3IExvb2thaGVhZE1pc21hdGNoRXJyb3IobG9va2FoZWFkLCBbLi4ucm91dGVyLmtleXMoKV0pIDtcblxuXHRlbHNlIHJldHVybiBfcGFyc2VfbGF6eShlb2YsIGdyYW1tYXIsIHRhYmxlLCBncmFtbWFyLmdldChleHBlY3RlZC5ub250ZXJtaW5hbCkuZ2V0KG5leHQpLCBzdHJlYW0gLCBleHBlY3RlZC5ub250ZXJtaW5hbCAsIG5leHQpO1xuXG59XG4iXX0=